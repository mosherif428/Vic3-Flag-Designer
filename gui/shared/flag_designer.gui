types FlagDesignerTypes
{
	type vbox_flag_designer = widget
	{
		datacontext = "[Country.GetFlag]"
		hbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			margin_right = 5
			margin_left = 5

			widget = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				hbox = {
					name = "flag_designer_center"
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					parentanchor = center
					margin_left = 500
					hbox = {
						layoutpolicy_horizontal = expanding

						vbox_flag_designer_preview = {
							layoutpolicy_vertical = expanding
							layoutpolicy_horizontal = expanding
							parentanchor = center
						}
					}

					expand = {}
				}
			}

			#divider_light = {
			#	layoutpolicy_vertical = expanding
			#	position = { 0 0 }
			#	margin = 10
			#}

			widget = {
				layoutpolicy_vertical = expanding
				layoutpolicy_horizontal = expanding
				hbox = {
					name = "flag_designer_right"
					parentanchor = right
					layoutpolicy_horizontal = preferred
					layoutpolicy_vertical = expanding
					vbox_flag_designer_tabs = {
					}

					#widget_flag_designer_editor_panel = {
					#	layoutpolicy_vertical = expanding
					#	layoutpolicy_horizontal = expanding
					#}
				}
			}
			expand = {}
		}
	}

	type pattern_list = dynamicgridbox
	{
		ignoreinvisible = yes
        maxverticalslots = 1000
        flipdirection = yes
        block "width"{
            datamodel_wrap = 4
            maxhorizontalslots = 4
        }
        layoutpolicy_vertical = expanding
        layoutpolicy_horizontal = expanding
        position = {0 0}
        block "datamodel" {
            datamodel = "[GetGlobalList('all_patterns')]"
        }
        item = {
            button = {
                size = { 64 64 }
                # Tooltip shows modifier description, useful for modifiers that affect a lot of different stats.
                block "itemcontext" {datacontext = "[GetScriptedGui('change_color_bg')]"} 
                onclick = "[ScriptedGui.Execute(GuiScope.SetRoot(Country.MakeScope).AddScope('pattern', MakeScopeFlag(Scope.GetFlagName)).End)]"
                background = {
                    using = Background_Area_Solid
                    margin = { 0 0 }
                }
                background = {
                    using = Background_Area_Light
                    visible = "[ScriptedGui.IsShown(GuiScope.SetRoot(Culture.MakeScope).AddScope('emblem', MakeScopeFlag(Scope.GetFlagName)).End)]"
                    margin = { 0 0 }
                }
            }
		}
	}

	type vbox_flag_designer_pattern_list = vbox
	{
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding
		background = Background_Area
		datacontext = "[GetGlobalList('all_patterns')]"
		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			text_multi = {
				text = "Patterns"
				background = dark_area
				autoresize = yes
				parentanchor = top
				margin_top = 5
				margin_bottom = 5
				margin_right = 100
				margin_left = 100

			}
			scrollbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				blockoverride "scrollbox_content"
				{
					pattern_list = {}
				}
			}
		}
	}

	type vbox_flag_designer_emblemlayout_list = vbox
	{
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding
		background = Background_Area
		datacontext = "[GetGlobalList('emblem_layouts')]"
		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			text_multi = {
				text = "Choose a layout"
				background = dark_area
				autoresize = yes
				parentanchor = top
				margin_top = 5
				margin_bottom = 5
				margin_right = 100
				margin_left = 100

			}
			scrollbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				blockoverride "scrollbox_content"
				{
					emblem_layouts = {}
				}
			}
		}
	}

	type vbox_flag_designer_bgcolors = vbox
	{
		layoutpolicy_horizontal = preferred
		layoutpolicy_vertical = shrinking
		background = Background_Area
		spacing = 5
		text_multi = {
			autoresize = yes
			background = dark_area
			max_width = 410
			margin_top = 5
			margin_bottom = 5
			margin_right = 100
			margin_left = 100
			text = "Colors"
		}
		hbox = {
			spacing = 5
			button = {
				name = "red"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/red.dds"
				datacontext = "[GetScriptedGui('change_color_red')]"
				blockoverride "button_color"
				{
					tintcolor = "red"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_red', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "orange"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/orange.dds"
				datacontext = "[GetScriptedGui('change_color_orange')]"
				blockoverride "button_color"
				{
					tintcolor = "orange"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_orange', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "yellow"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/yellow.dds"
				datacontext = "[GetScriptedGui('change_color_yellow')]"
				blockoverride "button_color"
				{
					tintcolor = "yellow"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_yellow', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/yellow_light.dds"
				datacontext = "[GetScriptedGui('change_color_yellow_light')]"
				blockoverride "button_color"
				{
					tintcolor = "yellow_light"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_yellow_light', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "white"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/white.dds"
				datacontext = "[GetScriptedGui('change_color_white')]"
				blockoverride "button_color"
				{
					tintcolor = "white"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_white', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "grey"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/grey.dds"
				datacontext = "[GetScriptedGui('change_color_grey')]"
				blockoverride "button_color"
				{
					tintcolor = "grey"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_grey', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "black"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/black.dds"
				datacontext = "[GetScriptedGui('change_color_black')]"
				blockoverride "button_color"
				{
					tintcolor = "black"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_black', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
		}
		hbox = {
			spacing = 5
			margin_bottom = 10
			button = {
				name = "brown"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/brown.dds"
				datacontext = "[GetScriptedGui('change_color_brown')]"
				blockoverride "button_color"
				{
					tintcolor = "brown"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_brown', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "green"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/green.dds"
				datacontext = "[GetScriptedGui('change_color_green')]"
				blockoverride "button_color"
				{
					tintcolor = "green"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_green', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "green_light"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/green_light.dds"
				datacontext = "[GetScriptedGui('change_color_green_light')]"
				blockoverride "button_color"
				{
					tintcolor = "green_light"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_green_light', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "blue_light"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/blue_light.dds"
				datacontext = "[GetScriptedGui('change_color_blue_light')]"
				blockoverride "button_color"
				{
					tintcolor = "blue_light"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_bluelight', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "blue"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/blue.dds"
				datacontext = "[GetScriptedGui('change_color_blue')]"
				blockoverride "button_color"
				{
					tintcolor = "blue"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_blue', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
			button = {
				name = "purple"
				using = default_button_action
				size = { 52 52 }
				texture = "gfx/interface/colors/purple.dds"
				datacontext = "[GetScriptedGui('change_color_purple')]"
				blockoverride "button_color"
				{
					tintcolor = "purple"
				}
				on_click = "[ScriptedGui.Execute( GuiScope.SetRoot( GetPlayer.MakeScope ).AddScope('change_color_purple', MakeScopeFlag(CoatOfArms.GetFlag)).End )]"
		
			}
		}
			
	}
	type vbox_flag_designer_preview = vbox
	{
		name = "flag_designer_previews"
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding

		
		hbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			parentanchor = right
			flowcontainer = {
				layoutpolicy_horizontal = expanding
				maximumsize = { 500 600 }
				parentanchor = vcenter|left
				icon = {
					size = { 340 542 }
					position = { 3 0 }
					texture = "gfx/interface/flag/fancy_flag_country_view.dds"
				}
				flag_3d_animated = {
					datacontext = "[Country.GetFlag]"
					size = { 550 309 }
					position = { 0 0 }
				}
			}
			flowcontainer = {
				parentanchor = top
				margin_top = -200
				direction = vertical
				layoutpolicy_horizontal = shrinking
				spacing = 50
				tiny_flag = {
					datacontext = "[AccessPlayer]"
				}
				small_flag = {
					datacontext = "[AccessPlayer]"
				}
				flag = {
					datacontext = "[AccessPlayer]"
				}
				large_flag = {
					datacontext = "[AccessPlayer]"
				}
			}
		}

		spacer = { size = { 0 10 } }

		
		expand = {}
	}

	type vbox_flag_designer_tabs = vbox
	{
		name = "flag_designer_tabs"
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding
		background = paper_bg
		max_width = 600
		parentanchor = top|hcenter
		hbox = {
			layoutpolicy_horizontal = growing
			margin_top = 10
			margin_right = 10
			margin_left = 10
			parentanchor = top|hcenter
			tab_button = {
				text = "Background"
				datacontext = "[GetGlobalList('all_patterns')]"

				onclick = "[GetVariableSystem.Set('flag_designer_window', 'background_panel')]"

				down = "[GetVariableSystem.HasValue('flag_designer_window', 'background_panel')]"
				layoutpolicy_horizontal = expanding
			}

			tab_button = {
				text = "Emblem Layout"
				onclick = "[GetVariableSystem.Set('flag_designer_window', 'emblem_layout')]"
				down = "[GetVariableSystem.HasValue('flag_designer_window', 'emblem_layout')]"

				using = CoatOfArmsDesignerClearEditState

				layoutpolicy_horizontal = expanding
			}

			tab_button = {
				text = "Emblem Instances"
				datacontext = "[CoatOfArmsDesigner.GetEmblemInstancesPanel]"
				onclick = "[GetVariableSystem.Set('flag_designer_window', 'emblem_instances')]"
				onclick = "[CoatOfArmsDesignerEmblemInstancesPanel.ResetSelectedEmblems]"
				onclick = "[CoatOfArmsDesignerEmblemInstancesPanel.UpdateTexturePreviewColors]"

				down = "[GetVariableSystem.HasValue('flag_designer_window', 'emblem_instances')]"

				using = CoatOfArmsDesignerClearEditState

				layoutpolicy_horizontal = expanding
			}
		}
		widget = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			background = Background_Area
			vbox_flag_designer_background_panel = {}
			vbox_flag_designer_emblemlayout_panel = {}
			vbox_flag_designer_embleminstances_panel = {}
		}
	}

	type vbox_flag_designer_background_panel = vbox
	{
		name = "background_panel"
		visible = "[GetVariableSystem.HasValue('flag_designer_window', 'background_panel')]"
		
		datacontext = "[GetGlobalList('all_patterns')]"
		
		vbox_flag_designer_bgcolors = {}
		
		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			hbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				vbox_flag_designer_pattern_list = {}
			}
		}

		expand = {}
	}

	type vbox_flag_designer_emblemlayout_panel = vbox
	{
		name = "emblem_layout"
		visible = "[GetVariableSystem.HasValue('flag_designer_window', 'emblem_layout')]"
		
		datacontext = "[GetGlobalList('emblem_layouts')]"
		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			hbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = preferred
				
			}
			hbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				vbox_flag_designer_emblemlayout_list = {}
			}
		}
	}

	type vbox_flag_designer_embleminstances_panel = vbox
	{
		name = "emblem_layout"
		visible = "[GetVariableSystem.HasValue('flag_designer_window', 'emblem_instances')]"
		
		datacontext = "[GetGlobalList('all_emblems')]"
		vbox_flag_designer_emblemcolors = {}
		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			hbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				vbox_flag_designer_emblem_list = {}
			}
		}
	}
}